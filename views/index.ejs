<%- include('partials/header.ejs'); -%>
<h1>Home</h1>


<div class="run">
    <form class="edit" action="/add" method="post">
        <label for="title">Title:</label>
        <input type="text" id="title" name="title" autocomplete="off" autofocus required>
        <label for="location">Location:</label>
        <input type="text" id="location" name="location" autocomplete="off" autofocus required>
        <label for="time">Time:</label>
        <input type="text" id="time" name="time" autocomplete="off" required>
        <label for="distance">Distance:</label>
        <input type="text" id="distance" name="distance" autocomplete="off" required>
        <label for="notes">Notes:</label>
        <input type="text" id="notes" name="notes" autocomplete="off">
        <a href="/allRuns"><button type="submit">Add Run</button></a>
    </form>
</div>


<% listRuns.reverse().slice(0, 2).forEach(run => { %>
    <div class="run-item" id="run-item-<%= run.id %>">
        <div class="view-mode">
            <p><strong>Title: <%= run.title %></strong></p>
            <p><strong>Location:</strong> <%= run.location %></p>
            <p><strong>Distance:</strong> <%= run.distance %></p>
            <p><strong>Time:</strong> <%= run.time %></p>
            <button onclick="toggleNotes('<%= run.id %>')">Show Notes</button>
            <p id="notes-<%= run.id %>" style="display: none;"><strong>Notes: <%= run.notes %></strong></p>
            <button onclick="toggleEdit('<%= run.id %>')">Edit</button>
        </div>
        <div class="edit-mode" hidden>
            <form action="/edit" method="post">
                <input type="hidden" name="id" value="<%= run.id %>">
                Title:<br>
                <input type="text" name="title" value="<%= run.title %>"><br>
                Location:<br>
                <input type="text" name="location" value="<%= run.location %>"><br>
                Distance:<br>
                <input type="text" name="distance" value="<%= run.distance %>"><br>
                Time:<br>
                <input type="text" name="time" value="<%= run.time %>"><br>
                Notes:<br>
                <input type="text" name="notes" value="<%= run.notes %>"><br>
                <button type="submit">Save Changes</button>
            </form>
        </div>
    </div>
<% }); %>


<div id="overlay" class="overlay">
    <div class="overlay-content">
        <span class="close" onclick="closeOverlay()">&times;</span>
        <h2>Run Details</h2>
        <p><strong>Title:</strong> <span id="overlay-title"></span></p>
        <p><strong>Location:</strong> <span id="overlay-location"></span></p>
        <p><strong>Distance:</strong> <span id="overlay-distance"></span></p>
        <p><strong>Time:</strong> <span id="overlay-time"></span></p>
        <p><strong>Notes:</strong> <span id="overlay-notes"></span></p>
    </div>
</div>



<script>
    function openOverlay(run) {
        document.getElementById('overlay-title').innerText = run.title;
        document.getElementById('overlay-location').innerText = run.location;
        document.getElementById('overlay-distance').innerText = run.distance;
        document.getElementById('overlay-time').innerText = run.time;
        document.getElementById('overlay-notes').innerText = run.notes;

        document.getElementById('overlay').style.display = 'block';
    }

    function closeOverlay(overlayId = 'overlay') {
    document.getElementById(overlayId).style.display = 'none';
}
function toggleEdit(runId) {
    const runItem = document.getElementById(`run-item-${runId}`);
    const viewMode = runItem.querySelector('.view-mode');
    const editMode = runItem.querySelector('.edit-mode');

    viewMode.hidden = !viewMode.hidden;
    editMode.hidden = !editMode.hidden;
}
function toggleNotes(runId) {
    const notesPara = document.getElementById(`notes-${runId}`);
    if (notesPara.style.display === "none") {
        notesPara.style.display = "block"; 
    } else {
        notesPara.style.display = "none"; 
    }
}
</script>
</body>
</html>
